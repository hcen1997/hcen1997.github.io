---
layout: post
---
# 2020年使用springboot的mybatis项目解析
在一个springboot项目, 使用mybatis会引入4个包.
可以分成3类,Mybatis,Mybatis-spring, Mybatis-springboot.  
Mybatis是数据持久化框架, 改善jdbc连接方式.  
Mybatis-spring 使用spring ioc方式管理Mybatis对象.  
Mybatis-spring-boot使用约定和默认配置的方式减少配置项
---
## Mybatis解析
### 架构
* 用户层: 
  1. CRUD映射的xml,接口  
  2. 配置文件
* 核心功能层: (java语句转换为sql并返回java结果)
  1. java函数参数处理(参数映射)
  2. sql解析
  3. sql执行
  4. 结果映射
* 支持层: 
  1. 配置加载
  2. 连接管理
  3. 事务
  4. 缓存
### 核心包
* org.apache.ibatis.session
  * 
org.apache.ibatis.mapping
org.apache.ibatis.type
org.apache.ibatis.executor
org.apache.ibatis.binding
### 类详细解析
* SqlSession 存储即中心  
  1. commit() crud() rollback()
  2. getConnection()  getConfiguration()
  3. 升级 getMapper()
  * 使用方式
    ```java
    try (SqlSession session = sqlSessionFactory
            .openSession()) {
      Blog blog = (Blog) session.selectOne(
         "org.mybatis.example.BlogMapper.selectBlog", 
         101);
    }
    ```
    ```java
    try (SqlSession session = sqlSessionFactory
            .openSession()) {
      BlogMapper mapper = session.getMapper(
            BlogMapper.class);
      Blog blog = mapper.selectBlog(101);
    }
    ```
    
### 参考

mybatis总结: https://www.cnblogs.com/cxuanBlog/p/12248536.html  
美团异常实例: https://tech.meituan.com/2020/06/18/inf-bom-mybatis.html  
mybatis文档: https://mybatis.org/mybatis-3/zh/getting-started.html  
mybatis spring 文档: http://mybatis.org/spring/zh/getting-started.html  
mybatis springboot 文档: http://mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/index.html  

